# ПАРСЕР ТЕКСТА
Утилита создана для получения информации в виде хэша из текста. Предпологается что будет использоваться нейтральный текст, такой как заметки и комментарии. По стандарту у события читаются только первые комментарии в странице, но читается все блоки, идущие подряд. Комментарии события читаются со всех страниц.
Парсер опирается на 3 вида меток - начало, разделитель и конец. Между началом и концом (или клонцом текста) вы распологаете нужные вам данные и, при неоюходимости, разделяете их резделителем.
По умолчанию есть 3 набора для парсинга, каждый из них предназначен для обработки текста определенных данных.
###### для заметок
```
<item> <+> <end>
```
###### для события
```
<event> <+> <end>
```
###### для страницы события, или для общих событий
```
<page> <+> <end>
```
######Пример
Код:
```
Amphicore::TextParser.parse_text("
Файербол требует газ, конечно же
<item> require_item 16 => 1 <end>
Ну и анимация конечно же
<item> cast_animation 4 
<+> fail_animation 7 <end>
Я забыл что делает этот ключ, но без него все ломается
<item> sacrifice_to_baal blood of virgin", 
Amphicore::TextParser::NOTE_PARSEKIT)
```
Результат:
```
{:require_item => "16 => 1", :cast_animation => "4", :fail_animation => "7", :sacrifice_to_baal => "blood of virgin"}
```
######ИНТЕРФЕЙС
Получить данные заметки по предмету (любому, который имеет заметки).
```
Amphicore::TextParser.get_note(item) # => (Hash)
```
Получить данные по событию.
```
(Game_Event).parse_data #=> (Hash)
```
Получить данные по странице с номером = page_num события.
```
(Game_Event).parse_page(page_num = nil) #=> (Hash)
```
Получить данные вражескому отряду.
```
(Game_Troop).parse_data #=> (Hash)
```
Получить данные по странице с номером = page_num Отряда.
```
(Game_Troop).parse_page((Integer) page_num = nil) #=> (Hash)
```
Получить данные по событию по набору страницы.
```
(Game_CommonEvent).parse_data #=> (Hash)
```
У общих событий одна страница. Это то же самое что и часть выше.
```
(Game_CommonEvent).parse_page #=> (Hash)
```
Все методы опираются на следующий метод, который проверяет кэш объекта, прежде чем парсить текст.
```
Amphicore::TextParser.get_note(item, text, parsekit) #=> (Hash)
```
#####НАБОРЫ ДЛЯ ПАРСИНГА
Существует возможность создать наборы свои наборы для парсинга со своими лексемами, а так же добавить им свои обработчики результатов.
```
Amphicore::TextParser.create_parsekit(start, separator, finish, opts) #=> ParseKit
(ParseKit)add_handler(key, &handler)
```
######ПРИМЕР
```
my_parsekit = Amphicore::TextParser.create_parsekit("<", "/", ">", 1)
my_parsekit.add_handler(:number, &:to_f)
p Amphicore::TextParser.parse_text("
Какой-нибудь текст <unhadled data/number 3>
", my_parsekit)
#=> {:unhandled => "data", :number => 3.0}
```
#СЕРИАЛИЗАЦИЯ
Автоматизирует создание, сохранение и загрузку объектов в глобальном пространстве. Оперирует именем и классом.
######ИНТЕРФЕЙС
Сериализует класс = klass под именем = name
```
Amphicore.serialize(name, klass)
```
######ПРИМЕРЫ
```
Amphicore.serialize("game_hash", Hash)
# ... тем временем, где-то в игре
$game_hash[:some_key] = "some_value"
```
Данный хэш уже сериализован в ядре и им можно пользоваться.
#ПСЕВДОНИМЫ
Скрипт имеет псевдонимы для свитчей и переменных.
######ИНТЕРФЕЙС
```
var #=> $game_variables
swi #=> $game_switches
sswi #=> $game_self_switches
svar #=> $game_self_variables (это как соственные свитчи, только переменные)
```
######ПРИМЕРЫ
```
var[1] = var[2] # присвоить первой переменной значение 2й
```
#РАСПРЕДЕЛИТЕЛЬ ТЕКСТА
Распределитель текста имеет всего один метод. На основании текста, ширины и шрифта возвращает массив строк, который *должен* уместится в данную ширину. Пользуется методом Bitmap.text_size, все претензии к нему T_T.
```
resolve(text, width, font = Amphicore::TEXT_RESOLVER_DEFAULT_FONT)
```
Это чуть более экспериментальная фитча, но пользуйтесь, чего бы и нет.
#НАСТРОЙКИ
Настраиваемую часть ядра вы можете найти по зкаладке CONFIG CORE.
```
#===============================================================================
#                                                                    CONFIG CORE
#===============================================================================
module Amphicore
  TEXT_NOTE_PARSER = ["<item>", "<\\+>", "<end>"] # набор лексем парсера записок
  TEXT_EVENT_PARSER = ["<event>", "<\\+>", "<end>"] # набор лексем парсера событий
  TEXT_EVENT_PAGE_PARSER = ["<page>", "<\\+>", "<end>"] # набор лексем парсера страниц событий
  
  TEXT_PARSER_CASE = 1 # чуствительность парсера к регистру
  
  TEXT_RESOLVER_DEFAULT_FONT = Font.new # Шрифт для распределителся текста по умолчанию
```
